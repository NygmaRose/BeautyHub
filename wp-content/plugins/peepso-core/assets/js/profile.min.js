function PsProfile(){this.cover={},this.cover.x_position_percent=0,this.cover.y_position_percent=0,this.$cover_ct=jQuery(".js-focus-cover"),this.$cover_image=jQuery("img#"+peepsodata.userid),this.initial_cover_position=this.$cover_image.attr("style"),this.avatar_use_gravatar=!1}var profile=new PsProfile;PsProfile.prototype.init=function(){var e=jQuery(".js-collapse-about-btn");0!==e.length&&e.on("click",function(e){e.preventDefault();var o=jQuery(".js-collapse-about");"none"===o.css("display")?o.show():o.hide()}),jQuery(".js-focus-cover").hover(function(){!1===pswindow.is_visible&&jQuery(".js-focus-change-cover").show()},function(){jQuery(".js-focus-change-cover").hide()}),jQuery(".ps-tab__bar").unbind("click");var o=this;this.$cover_image.one("load",function(){o.fix_horizontal_padding()}).each(function(){this.complete&&jQuery(this).load()}),jQuery(window).on("resize.focus-image",jQuery.proxy(this.fix_horizontal_padding_debounced,this));var t=jQuery(".ps-page--preferences");t.length&&(t.find("input[type=checkbox]").on("click.savepref",profile.save_preference),t.find("select").on("change",profile.save_preference),t.find(".ps-js-dropdown input[type=hidden]").on("change",profile.save_preference),t.find(".ps-preferences__checkbox").find("input[type=checkbox]").off("click.savepref").on("click.savepref",profile.save_notification))},PsProfile.prototype.activate_tab=function(e,o,t){return e.preventDefault(),jQuery(e.target).addClass("active").siblings("[data-toggle=tab]").removeClass("active"),jQuery(t).hide(),jQuery(o).show(),!1},PsProfile.prototype.new_like=function(){return peepso.postJson("profile.like",{user_id:peepsodata.userid},function(e){e.success?jQuery(".profile-social.profile-interactions").html(e.data.html):psmessage.show("",e.errors[0]).fade_out(psmessage.fade_time)}),!1},PsProfile.prototype.unblock_user=function(e,o){if(!this.unblocking_user){o&&(o=jQuery(o)).find("img").css("display","inline");var t={uid:peepsodata.currentuserid,user_id:e};this.unblocking_user=!0,$PeepSo.postJson("activity.unblockuser",t,jQuery.proxy(function(o){this.unblocking_user=!1,o.success&&(jQuery(".ps-js-focus--"+e).find(".ps-focus-actions, .ps-focus-actions-mobile").html(o.data.actions),psmessage.show(o.data.header,o.data.message,psmessage.fade_time))},this))}},PsProfile.prototype.report_user=function(){var e,o,t=jQuery("#activity-report-title").html();content=jQuery("#activity-report-content").html(),content=content.replace("{post-content}","Profile"),content=content.replace("{post-id}",peepsodata.userid+""),ps_observer.add_filter("activity_report_action",e=function(e){return"profile.report"},10,1),ps_observer.add_filter("activity_report_params",o=function(e){var o=jQuery.extend({},e);return o.user_id=o.act_id,o.act_id=void 0,o.uid=void 0,o},10,1),actions=jQuery("#activity-report-actions").html(),pswindow.show(t,content).set_actions(actions).refresh(),jQuery("#ps-window").one("pswindow.hidden",function(){ps_observer.remove_filter("activity_report_action",e,10),ps_observer.remove_filter("activity_report_params",o,10)}),jQuery(window).one("report.submitted",function(e,o){pswindow.show("Profile Reported",o.notices[0])})},PsProfile.prototype.confirm_remove_cover_photo=function(){var e=jQuery("#delete-confirmation #delete-title").html(),o=jQuery("#delete-confirmation #delete-content").html();pswindow.show(e,o)},PsProfile.prototype.remove_cover_photo=function(e){var o={uid:peepsodata.currentuserid,user_id:e,_wpnonce:jQuery("#_covernonce").val()};$PeepSo.postJson("profile.remove_cover_photo",o,function(e){e.success&&window.location.reload()})},PsProfile.prototype.reposition_cover=function(){jQuery(".js-focus-gradient",".js-focus-cover").hide(),jQuery(".js-focus-change-cover > a",".js-focus-cover").hide(),jQuery(".reposition-cover-actions",".js-focus-cover").show(),jQuery(".js-focus-cover").addClass("ps-focus-cover-edit");var e=this,o=jQuery(".js-focus-cover").height()-jQuery("img#"+peepsodata.userid).height(),t=jQuery(".js-focus-cover").width()-jQuery("img#"+peepsodata.userid).width();jQuery("img#"+peepsodata.userid).draggable({cursor:"move",drag:function(e,i){i.position.top<o&&(i.position.top=o),i.position.top>0&&(i.position.top=0),i.position.left<t&&(i.position.left=t),i.position.left>0&&(i.position.left=0)},stop:function(o,t){var i=jQuery("img#"+peepsodata.userid),s=i.closest(".js-focus-cover"),r=100*t.position.top/s.height();r=Math.round(1e4*r)/1e4,y=100*t.position.left/s.width(),y=Math.round(1e4*y)/1e4,e.cover.x_position_percent=r,e.cover.y_position_percent=y,i.css("top",r+"%"),i.css("left",y+"%")}})},PsProfile.prototype.cancel_reposition_cover=function(){jQuery(".js-focus-gradient",".js-focus-cover").show(),jQuery(".js-focus-change-cover > a",".js-focus-cover").show(),jQuery(".reposition-cover-actions",".js-focus-cover").hide(),jQuery(".js-focus-cover").removeClass("ps-focus-cover-edit"),jQuery("img#"+peepsodata.userid).attr("style",this.initial_cover_position),jQuery("img#"+peepsodata.userid).draggable("destroy")},PsProfile.prototype.save_reposition_cover=function(){var e={user_id:peepsodata.userid,x:this.cover.x_position_percent,y:this.cover.y_position_percent,_wpnonce:jQuery("#_photononce").val()},o=this;jQuery(".reposition-cover-actions",".js-focus-cover").hide(),jQuery(".ps-reposition-loading",".js-focus-cover").show(),jQuery(".js-focus-cover").removeClass("ps-focus-cover-edit"),$PeepSo.postJson("profile.reposition_cover",e,function(e){jQuery(".ps-reposition-loading",".js-focus-cover").hide(),o.initial_cover_position=jQuery("img#"+peepsodata.userid).attr("style"),o.cancel_reposition_cover()})},PsProfile.prototype.confirm_remove_avatar=function(){var e=jQuery("#delete-confirmation #delete-title").html(),o=jQuery("#delete-confirmation #delete-content").html();pswindow.show(e,o)},PsProfile.prototype.remove_avatar=function(e){var o={uid:peepsodata.currentuserid,user_id:e,_wpnonce:jQuery("#_photononce").val()};$PeepSo.postJson("profile.remove_avatar",o,function(e){e.success&&window.location.reload()})},PsProfile.prototype.delete_profile=function(){var e=jQuery("#profile-delete-title").html(),o=jQuery("#profile-delete-content").html();pswindow.show(e,o)},PsProfile.prototype.delete_profile_action=function(){$req={};var e={uid:peepsodata.currentuserid};$PeepSo.postJson("profile.delete_profile",e,function(e){e.success?window.location=e.data.url:psmessage.show("",e.errors[0]).fade_out(psmessage.fade_time)})},PsProfile.prototype.show_avatar_dialog=function(){jQuery(".ps-js-error").html("");var e=jQuery("#dialog-upload-avatar"),o=e.find("#dialog-upload-avatar-title").html(),t=e.find("#dialog-upload-avatar-content").html(),i=e.find(".dialog-action").html(),s=pswindow.show(o,t).set_actions(i).$container.find(".ps-dialog");s.addClass("ps-dialog-wide"),ps_observer.add_filter("pswindow_close",function(){s.removeClass("ps-dialog-wide")},10,1),this.init_avatar_fileupload(),jQuery("#ps-window").on("pswindow.hidden",function(){jQuery(".upload-avatar .fileupload:visible").fileupload("destroy")})},PsProfile.prototype.init_avatar_fileupload=function(){var e=this;jQuery(".upload-avatar .fileupload:visible").fileupload({formData:{user_id:peepsodata.userid,_wpnonce:jQuery("#_photononce").val()},dataType:"json",url:peepsodata.ajaxurl_legacy+"profile.upload_avatar?avatar",add:function(e,o){if(o.files[0].type.length&&!/(\.|\/)(jpe?g|png)$/i.test(o.files[0].type)){var t=jQuery("#profile-avatar-error-filetype").text();jQuery(".ps-js-error").html(t)}else if(parseInt(o.files[0].size)>peepsodata.upload_size){var i=jQuery("#profile-avatar-error-filesize").text();jQuery(".ps-js-error").html(i)}else jQuery("#ps-window .ps-loading-image").show(),jQuery("#ps-window .show-avatar, #ps-window .show-thumbnail, #ps-window .upload-avatar").hide(),jQuery(".ps-js-error").hide(),pswindow.refresh(),o.submit()},done:function(o,t){var i=t.result;if(i.success){var s=jQuery("#dialog-upload-avatar-content",jQuery(i.data.html)),r=jQuery("#dialog-upload-avatar .dialog-action").html(),a="?"+Math.random();jQuery(".js-focus-avatar img",s).attr("src",i.data.image_url+a),jQuery(".imagePreview img",s).attr("src",i.data.orig_image_url+a),jQuery(".imagePreview",s).after('<input type="hidden" name="is_tmp" value="1"/>'),jQuery(".ps-js-has-avatar",s).show(),jQuery(".ps-js-no-avatar",s).hide(),pswindow.set_content(s),pswindow.set_actions(r),jQuery("#imagePreview img").one("load",function(){pswindow.refresh()}),e.init_avatar_fileupload(),jQuery("#ps-window button[name=rep_submit]").removeAttr("disabled").addClass("ps-btn-primary"),e.invalid_avatar_upload=!1,e.avatar_use_gravatar=!1}else jQuery("#ps-window .show-avatar, #ps-window .show-thumbnail, #ps-window .upload-avatar").show(),jQuery(".ps-js-error").html(i.errors).show(),jQuery("#ps-window .ps-loading-image").hide(),jQuery("#ps-window button[name=rep_submit]").attr("disabled","disabled").removeClass("ps-btn-primary"),e.invalid_avatar_upload=!0}})},PsProfile.prototype.confirm_avatar=function(e){var o,t;this.invalid_avatar_upload||(o=this.confirm_avatar)._loading||(o._loading=!0,e&&(e=jQuery(e)).attr("disabled","disabled"),t={user_id:peepsodata.userid,use_gravatar:this.avatar_use_gravatar?1:0,_wpnonce:jQuery("#_photononce").val()},peepso.postJson("profile.confirm_avatar",t,function(t){t&&t.success?window.location.reload():(o._loading=!1,e&&e.removeAttr("disabled"))}))},PsProfile.prototype.show_cover_dialog=function(){jQuery(".ps-js-error").html("");var e=jQuery("#dialog-upload-cover"),o=e.find("#dialog-upload-cover-title").html(),t=e.find("#dialog-upload-cover-content").html();pswindow.show(o,t),this.init_cover_fileupload(),jQuery("#ps-window").on("pswindow.hidden",function(){jQuery(".upload-cover .fileupload:visible").fileupload("destroy")})},PsProfile.prototype.init_cover_fileupload=function(){var e=this;jQuery(".upload-cover .fileupload:visible").fileupload({formData:{user_id:peepsodata.userid,_wpnonce:jQuery("#_photononce").val()},dataType:"json",url:peepsodata.ajaxurl_legacy+"profile.upload_cover?cover",add:function(e,o){if(o.files[0].type.length&&!/(\.|\/)(jpe?g|png)$/i.test(o.files[0].type)){var t=jQuery("#profile-cover-error-filetype").text();jQuery(".ps-js-error").html(t)}else if(parseInt(o.files[0].size)>peepsodata.upload_size){var i=jQuery("#profile-cover-error-filesize").text();jQuery(".ps-js-error").html(i)}else jQuery("#ps-window .ps-loading-image").show(),jQuery("#ps-window .upload-cover").hide(),o.submit()},done:function(o,t){var i,s=t.result;jQuery("#ps-window .ps-loading-image").hide(),jQuery("#ps-window .upload-cover").show(),s.success?(i=s.data.image_url+"?"+Math.random(),jQuery(".cover-image").attr("src",i).css("top","0").css("left","0").removeClass("default").addClass("has-cover"),jQuery(".ps-focus-image-mobile").attr("style","background:url("+i+") no-repeat center center;"),ps_observer.do_action("profile_cover_update",peepsodata.userid,i),pswindow.fade_out("slow"),jQuery("#profile-reposition-cover").show(),jQuery("#dialog-upload-cover-content").html(s.data.html),pswindow.set_content(jQuery("#dialog-upload-cover-content",s.data.html).html()),e.fix_horizontal_padding_debounced(),e.init_cover_fileupload()):jQuery(".ps-js-error").html(s.errors)}})},PsProfile.prototype.fix_horizontal_padding=function(){var e;this.$cover_image.css({height:"auto",width:"100%",minWidth:"100%",maxWidth:"100%"}),e=.375*this.$cover_ct.width(),e=Math.max(e,this.$cover_ct.height()),this.$cover_image.height()<e&&this.$cover_image.css({height:e,width:"auto",minWidth:"100%",maxWidth:"none"}),this.initial_cover_position=this.$cover_image.attr("style")},PsProfile.prototype.fix_horizontal_padding_debounced=_.debounce(function(){this.fix_horizontal_padding()},300),PsProfile.prototype.edit_field=function(e){var o,t,i=jQuery(e).closest(".ps-list-info-content"),s=i.find("input[type=text],input[type=checkbox],input[type=radio],textarea,select").eq(0),r=(s.attr("type")||"").toLowerCase();return i.find(".ps-list-info-content-text").hide(),i.find(".ps-list-info-content-form").show(),i.find(".ps-list-info-content-error").hide(),i.find(".ps-js-validation").removeClass("ps-alert-danger"),"checkbox"===r?(o=(s=i.find("input[type=checkbox]:checked")).map(function(){return this.value}),o=jQuery.makeArray(o).join(","),i.data("original-value",o)):"radio"===r?(s=i.find("input[type=radio]:checked"),i.data("original-value",s.val())):s.hasClass("datepicker")?(i.data("original-value",s.data("value")),i.data("original-formatted",s.val()),s.focus()):"text"===r||"TEXTAREA"===s.prop("tagName")?(i.data("original-value",s.val()),(t=s.next(".ps-js-counter")).length&&(t.show(),s.off("input").on("input",_.throttle(function(e){t.html(e.target.value.length)},500)).triggerHandler("input")),s.focus()):(i.data("original-value",s.val()),s.focus()),!1},PsProfile.prototype.cancel_field=function(e){var o,t,i=jQuery(e).closest(".ps-list-info-content"),s=i.find("input[type=text],input[type=checkbox],input[type=radio],textarea,select").eq(0),r=(s.attr("type")||"").toLowerCase(),a=s.data("id");return i.find(".ps-list-info-content-form").hide(),i.find(".ps-list-info-content-text").show(),i.find(".ps-list-info-content-error").hide(),"checkbox"===r?(o=i.data("original-value").split(","),(s=i.find("input[type=checkbox]")).each(function(){this.checked=o.indexOf(this.value)>-1})):"radio"===r?(o=i.data("original-value"),(s=i.find("input[type=radio]")).each(function(){this.checked=this.value===o})):s.hasClass("datepicker")?(s.data("value",i.data("original-value")),s.val(i.data("original-formatted"))):s.val(i.data("original-value")),this.field_changed_list&&this.field_changed_list.length&&(t=this.field_changed_list.indexOf(a))>-1&&this.field_changed_list.splice(t,1),!1},PsProfile.prototype.save_field=function(e){var o,t,i,s=jQuery(e),r=s.closest(".ps-list-info-content").closest(".ps-js-profile-item"),a=r.find("input[type=text],input[type=checkbox],input[type=radio],textarea,select"),n=r.find("button"),d=r.find(".ps-list-info-content-data"),p=(a.attr("type")||"").toLowerCase(),l=a.data("id");"checkbox"===p?(o=a.filter(":checked").map(function(){return this.value}),o=jQuery.makeArray(o),o=JSON.stringify(o)):o="radio"===p?a.filter(":checked").val():a.hasClass("datepicker")?a.data("value"):ps_observer.apply_filters("profile_field_save",a.val(),a),t={user_id:peepsodata.currentuserid,view_user_id:peepsodata.userid,id:l,value:o},this.save_field_saving=!0,this.change_beforeunload(),a.attr("disabled","disabled"),n.attr("disabled","disabled"),s.find("img").show();var c=this;return $PeepSo.postJson("profilefieldsajax.save",t,function(e){var o,t=0;if(s.find("img").hide(),a.removeAttr("disabled"),n.removeAttr("disabled"),c.save_field_saving=!1,e.success)o=e.data||{},r.find(".ps-list-info-content-form").hide(),r.find(".ps-list-info-content-text").show(),r.find(".ps-list-info-content-error").hide(),void 0!=o.display_value?d.html(o.display_value):"select"===a.prop("tagName").toLowerCase()?d.html(a.find("option:selected").text()):d.html(a.val()),void 0!==o.profile_completeness&&(+o.profile_completeness>=100?(t++,jQuery(".ps-completeness-status").hide(),jQuery(".ps-completeness-bar").hide()):(jQuery(".ps-completeness-status").html(o.profile_completeness_message).show(),jQuery(".ps-completeness-bar").show().children("span").css({width:+o.profile_completeness+"%"}))),void 0!==o.missing_required&&(+o.missing_required<=0?(t++,jQuery(".ps-missing-required-message").hide()):jQuery(".ps-missing-required-message").html(o.missing_required_message).show()),t>=2?jQuery(".ps-completeness-info").hide():jQuery(".ps-completeness-info").show(),c.field_changed_list&&c.field_changed_list.length&&(i=c.field_changed_list.indexOf(l))>-1&&c.field_changed_list.splice(i,1),r.addClass("ps-list-info-success"),setTimeout(function(){r.removeClass("ps-list-info-success")},1e3),ps_observer.do_action("profile_field_updated");else{var p,u,f=r.find(".ps-list-info-content-form"),h=[];if(f.find(".ps-js-validation").removeClass("ps-alert-danger"),e.errors[0])for(p in e.errors[0])(u=f.find(".ps-js-validation-"+p)).length?u.addClass("ps-alert-danger"):h.push(e.errors[0][p]);u=f.find(".ps-list-info-content-error").hide(),h.length&&(h=h.join("<br>"),u.html(h).show()),r.addClass("ps-list-info-error"),setTimeout(function(){r.removeClass("ps-list-info-error")},1e3)}}),!1},PsProfile.prototype.field_keydown=function(e,o){return 13!==o.keyCode||(setTimeout(function(){jQuery(e).closest(".ps-list-info-content").find(".ps-js-btn-save").trigger("click")},1),!1)},PsProfile.prototype.field_changed=function(e,o){var t=jQuery(e).data("id");return this.field_changed_list||(this.field_changed_list=[]),-1===this.field_changed_list.indexOf(t)&&this.field_changed_list.push(t),this.change_beforeunload(),!0},PsProfile.prototype.change_beforeunload=function(){if(!this.onbeforeunload_changed){var e=this;this.onbeforeunload_changed=window.onbeforeunload||function(){},window.onbeforeunload=function(){return e.save_field_saving?peepsodata.profile_saving_notice||"The system is currently saving your changes.":e.field_changed_list.length?peepsodata.profile_unsaved_notice||"There are unsaved changes on this page.":void 0}}},PsProfile.prototype.change_privacy=function(e){var o=jQuery(e),t=o.closest(".ps-js-dropdown"),i=t.find(".ps-js-dropdown-toggle"),s=t.find("input[type=hidden]"),r={},a="[class*=ps-icon-]",n=".ps-privacy-title",d=s.data("id"),p=(s.val(),i.find(a).attr("class")),l=i.find(n).html(),c=o.data("optionValue"),u=o.find(a).attr("class"),f=o.find("span").html();o.parent().children("[data-option-value]").each(function(){var e=jQuery(this),o=e.data("optionValue"),t=e.find(a).attr("class");r[o]=t}),i.find(a).attr("class",u),i.find(n).html(f),peepso.postJson("profilefieldsajax.save_acc",{user_id:peepsodata.currentuserid,view_user_id:peepsodata.userid,id:d,acc:c},function(e){e.success?s.val(c):(i.find(a).attr("class",p),i.find(n).html(l))})},PsProfile.prototype.use_gravatar=function(){var e=this;$PeepSo.postJson("profile.use_gravatar",{},function(o){if(o.success){var t=jQuery("#dialog-upload-avatar-content",jQuery(o.data.html)),i=jQuery("#dialog-upload-avatar .dialog-action").html(),s=(Math.random(),o.data.image_url);s=s+(s.indexOf("?")>=0?"&rand=":"?rand=")+Math.random(),jQuery(".js-focus-avatar img",t).attr("src",s),jQuery(".imagePreview img",t).attr("src",s),jQuery(".imagePreview",t).after('<input type="hidden" name="is_tmp" value="1"/>'),jQuery(".ps-js-has-avatar",t).show(),jQuery(".ps-js-no-avatar",t).hide(),jQuery(".ps-js-crop-avatar",t).hide(),pswindow.set_content(t),pswindow.set_actions(i),jQuery("#imagePreview img").one("load",function(){pswindow.refresh()}),e.init_avatar_fileupload(),jQuery("#ps-window button[name=rep_submit]").removeAttr("disabled").addClass("ps-btn-primary"),e.invalid_avatar_upload=!1,e.avatar_use_gravatar=!0}})},PsProfile.prototype.save_preference=function(e){var o=jQuery(e&&e.target?e.target:e),t=o.closest(".ps-form-controls").find(".ps-js-loading"),i={};i.user_id=peepsodata.currentuserid,i.view_user_id=peepsodata.userid,i.meta_key=o.attr("name"),i.value=o.is(":checkbox")?o[0].checked?1:0:o.val(),t.find("i").stop().hide(),t.find("img").show(),$PeepSo.postJson("profilepreferencesajax.save",i,function(e){t.find("img").hide(),t.find("i").show().delay(800).fadeOut()})},PsProfile.prototype.save_notification=function(e){var o=jQuery(e&&e.target?e.target:e),t=o.closest(".ps-form-controls").find(".ps-js-loading"),i={};i.user_id=peepsodata.currentuserid,i.view_user_id=peepsodata.userid,i.fieldname=o.attr("name"),i.value=o.is(":checkbox")?o[0].checked?1:0:o.val(),t.find("i").stop().hide(),t.find("img").show(),$PeepSo.postJson("profilepreferencesajax.save_notifications",i,function(e){t.find("img").hide(),t.find("i").show().delay(800).fadeOut(),e.success})},PsProfile.prototype.profile_deletion=function(){var e="ps-js-dialog-profile-deletion",o=jQuery("#"+e);this.deleting_profile||(o.length||((o=jQuery(peepsoprofiledata.profile_deletion_popup_content)).attr("id",e),o.appendTo(document.body),o.on("click",".ps-js-cancel",function(e){e.preventDefault(),e.stopPropagation(),o.hide()}),o.on("click",".ps-js-submit",jQuery.proxy(function(e){var t=jQuery(e.currentTarget).find("img").show(),i={password:o.find("input[type=password]").val()};this.deleting_profile=!0,peepso.postJson("profile.delete_profile",i,jQuery.proxy(function(e){this.deleting_profile=!1,t.hide(),e.success?(o.find(".ps-js-error").hide(),e.data&&(psmessage.show("",e.data.messages),setTimeout(function(){window.location=e.data.url},2e3))):e.errors&&o.find(".ps-js-error").html(e.errors[0]).show()},this))},this))),o.find("input[type=password]").val(""),o.find(".ps-js-error").hide(),o.show())},PsProfile.prototype.request_account_data=function(){console.log("this");var e="ps-js-dialog-profile-request-account-data",o=jQuery("#"+e);this.requesting_data||(o.length||((o=jQuery(peepsoprofiledata.profile_account_data_popup_content)).attr("id",e),o.appendTo(document.body),o.on("click",".ps-js-cancel",function(e){e.preventDefault(),e.stopPropagation(),o.hide()}),o.on("click",".ps-js-submit",jQuery.proxy(function(e){var t=jQuery(e.currentTarget).find("img").show(),i={password:o.find("input[type=password]").val()};this.requesting_data=!0,peepso.postJson("profile.request_account_data",i,jQuery.proxy(function(e){this.requesting_data=!1,t.hide(),e.success?(o.find(".ps-js-error").hide(),e.data&&(psmessage.show("",e.data.messages),setTimeout(function(){window.location=e.data.url},2e3))):e.errors&&o.find(".ps-js-error").html(e.errors[0]).show()},this))},this))),o.find("input[type=password]").val(""),o.find(".ps-js-error").hide(),o.show())},PsProfile.prototype.download_account_data=function(){var e="ps-js-dialog-profile-download-account-data",o=jQuery("#"+e);this.requesting_data||(o.length||((o=jQuery(peepsoprofiledata.profile_download_account_data_popup_content)).attr("id",e),o.appendTo(document.body),o.on("click",".ps-js-cancel",function(e){e.preventDefault(),e.stopPropagation(),o.hide()}),o.on("click",".ps-js-submit",jQuery.proxy(function(e){var t=jQuery(e.currentTarget).find("img").show(),i={password:o.find("input[type=password]").val()};this.requesting_data=!0,peepso.postJson("profile.download_account_data",i,jQuery.proxy(function(e){this.requesting_data=!1,t.hide(),e.success?(o.find(".ps-js-error").hide(),e.data&&(psmessage.show("",e.data.messages),setTimeout(function(){window.location=e.data.url},2e3))):e.errors&&o.find(".ps-js-error").html(e.errors[0]).show()},this))},this))),o.find("input[type=password]").val(""),o.find(".ps-js-error").hide(),o.show())},PsProfile.prototype.delete_account_data_archive=function(){var e="ps-js-dialog-profile-delete-account-data-archive",o=jQuery("#"+e);this.delete_account_data||(o.length||((o=jQuery(peepsoprofiledata.profile_delete_account_data_archive_popup_content)).attr("id",e),o.appendTo(document.body),o.on("click",".ps-js-cancel",function(e){e.preventDefault(),e.stopPropagation(),o.hide()}),o.on("click",".ps-js-submit",jQuery.proxy(function(e){var t=jQuery(e.currentTarget).find("img").show(),i={password:o.find("input[type=password]").val()};this.delete_account_data=!0,peepso.postJson("profile.delete_account_data_archive",i,jQuery.proxy(function(e){this.delete_account_data=!1,t.hide(),e.success?(o.find(".ps-js-error").hide(),e.data&&(psmessage.show("",e.data.messages),setTimeout(function(){window.location=e.data.url},2e3))):e.errors&&o.find(".ps-js-error").html(e.errors[0]).show()},this))},this))),o.find("input[type=password]").val(""),o.find(".ps-js-error").hide(),o.show())},jQuery(document).ready(function(){profile.init()});