!function(e){function t(t){var i,n,r,a,s,o,p,d=e(t),u=d.find("input[type=text],input[type=email],input[type=password],input[type=checkbox],input[type=radio],textarea,select");if(u.length)return i=u.eq(0).data("id"),n=u.eq(0).attr("name")||"","checkbox"===(r=(u.eq(0).attr("type")||"").toLowerCase())?(a=u.filter(":checked").map(function(){return this.value}),a=e.makeArray(a),a=JSON.stringify(a)):a="radio"===r?u.filter(":checked").val():u.hasClass("datepicker")?u.data("value"):ps_observer.apply_filters("profile_field_save",u.val(),u),["username","email","password","password2"].indexOf(n)>=0?(s=!0,o=peepsodata.ajaxurl_legacy+"profilefieldsajax.validate_register",(p={}).name=n,p[n]=a,"password2"===n&&(u=u.closest(".ps-register-form form").find("[name=password]"),p.password=u.val())):(s=!1,o=peepsodata.ajaxurl_legacy+"profilefieldsajax.validate",p={user_id:peepsodata.currentuserid,view_user_id:peepsodata.userid,id:i,value:a}),e.ajax({url:o,type:"post",dataType:"json",data:p}).done(function(e){var t,i=d.find(".ps-form-error");e.errors&&e.errors.length?(i.empty(),t=s?e.errors:e.errors[0],_.each(t,function(e){i.append("<li>"+e+"</li>")}),i.show()):i.hide()})}var i=e(document).find(".ps-register-form form");i.on("input","input[type=text]:not(.ps-js-field-location),input[type=email],input[type=password],textarea",_.debounce(function(i){t(e(i.target).closest(".ps-form-field"))},500)).on("click","input[type=checkbox],input[type=radio]",_.debounce(function(i){t(e(i.target).closest(".ps-form-field"))},100)).on("change","select",_.debounce(function(i){t(e(i.target).closest(".ps-form-field"))},100)).on("submit.ps-register",function(i){var n,r,a,s,o;return i.preventDefault(),i.stopPropagation(),n=e(this),r=n.find(".ps-form-field"),a=r.find("input.datepicker"),s=n.find("button[type=submit]"),o=[],errors=[],n.data("ps-submitting")||(n.data("ps-submitting",!0),r.each(function(){var e=t(this);e&&o.push(e)}),s.find("img").show(),e.when.apply(e,o).done(function(){var t;s.find("img").hide();for(t in arguments)if(arguments[t][0].errors)return void n.removeData("ps-submitting");a.length&&a.each(function(){var t=e(this),i=t.data("value");i&&($hidden=e('<input type="hidden" name="'+t.attr("name")+'" />'),t.removeAttr("name"),$hidden.insertAfter(t),$hidden.val(i))}),r.length&&r.each(function(){$input=e(this).find("input[type=text],input[type=email],input[type=password],input[type=checkbox],input[type=radio],textarea,select"),ps_observer.do_action("profile_field_save_register",$input)}),n.off("submit.ps-register"),setTimeout(function(){s.click()},100)})),!1});var n=i.find("input[name=terms], input[name=privacy]"),r=i.find("[type=submit]");n.length&&n.on("click.ps-register-consent",function(e){var t=[];n.each(function(){t.push(!!this.checked)}),t.indexOf(!1)>=0?(e.stopPropagation(),r.attr("disabled","disabled")):r.removeAttr("disabled")}).triggerHandler("click.ps-register-consent"),e(function(){setTimeout(function(){i.find(".ps-js-location-wrapper .ps-btn").on("mousedown",_.debounce(function(i){t(e(i.target).closest(".ps-form-field"))},100))},1e3)})}(jQuery);