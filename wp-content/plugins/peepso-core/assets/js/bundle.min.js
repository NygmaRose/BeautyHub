!function s(a,r,p){function h(e,t){if(!r[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(u)return u(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var o=r[e]={exports:{}};a[e][0].call(o.exports,function(t){return h(a[e][1][t]||t)},o,o.exports,s,a,r,p)}return r[e].exports}for(var u="function"==typeof require&&require,t=0;t<p.length;t++)h(p[t]);return h}({1:[function(t,e,i){"use strict";var n,o;n=jQuery,o=_.debounce(function(t){t.style.height="",t.style.height=+t.scrollHeight+2+"px"},1),n.fn.ps_autosize=function(){return this.each(function(){o(this),n(this).off("input.ps-autosize").on("input.ps-autosize",function(){o(this)})})}},{}],2:[function(t,e,i){"use strict";!function(r){function t(t){var e=r(t.currentTarget).closest(".ps-js-dropdown"),i=e.find(".ps-js-dropdown-menu"),n=r(document),o=e.data("ps-guid");if(o||(o=_.uniqueId("ps-dropdown-"),e.data("ps-guid",o)),i.is(":visible"))return t.stopPropagation(),n.off("click."+o),void i.hide();i.show(),n.one("click."+o,function(){i.hide()})}function e(t){var e,i="[class*=ps-icon-]",n=".ps-js-dropdown-label",o=r(t.currentTarget),s=o.closest(".ps-js-dropdown"),a=s.find(".ps-js-dropdown-toggle");s.hasClass("ps-js-dropdown--privacy")&&((e=s.children("[type=hidden]")).val(o.data("option-value")),e.triggerHandler("change"),a.find(i).attr("class",o.find(i).attr("class")),a.find(n).html(o.find(n).html()))}r(function(){r(document).on("click.ps-dropdown",".ps-js-dropdown-menu a",e).on("click.ps-dropdown",".ps-js-dropdown-toggle",t)})}(jQuery)},{}],3:[function(t,e,i){"use strict";t("./autosize"),t("./dropdown"),t("./share"),t("./time"),t("./safety-warning"),t("./posttabs"),t("./postbox-legacy"),t("./postbox"),t("./notification-general"),t("./widgets"),t("./third-party-fixes"),t("./lightbox")},{"./autosize":1,"./dropdown":2,"./lightbox":4,"./notification-general":5,"./postbox":10,"./postbox-legacy":9,"./posttabs":11,"./safety-warning":12,"./share":13,"./third-party-fixes":14,"./time":15,"./widgets":16}],4:[function(t,e,i){"use strict";var n,p=s(t("imagesloaded")),o=s(t("swipejs"));function s(t){return t&&t.__esModule?t:{default:t}}n=new(function(r,s){var e=peepsolightboxdata.template.replace(/>\s+</g,"><"),t="ps-lightbox-data--opened",i="ps-lightbox-close--invert";function n(){}return n.prototype={init:function(){this.$container||(this.$container=r(e),this.$padding=this.$container.find(".ps-lightbox-padding"),this.$wrapper=this.$container.find(".ps-lightbox-wrapper"),this.$close=this.$container.find(".ps-lightbox-close"),this.$object=this.$container.find(".ps-lightbox-object"),this.$prev=this.$container.find(".ps-lightbox-arrow-prev"),this.$next=this.$container.find(".ps-lightbox-arrow-next"),this.$spinner=this.$container.find(".ps-lightbox-spinner"),this.$attachment=this.$container.find(".ps-lightbox-data"),this.$btnattachment=this.$container.find(".ps-lightbox-data-toggle"),this.$imagelink=this.$container.find(".ps-lightbox-imagelink"),this.attachevents(),this.$container.appendTo(document.body)),this.isMobile()&&(this.$viewport||(this.$viewport=r("meta[name=viewport]"),this.$viewport.length||(this.$viewport=r('<meta name="viewport" content="" />').appendTo("head"))),this.vpNoZoom="width=device-width, user-scalable=no",this.vpValue||(this.vpValue=this.$viewport.attr("content"),this.$viewport.attr("content",this.vpNoZoom))),this.options.simple?this.$container.addClass("ps-lightbox-simple"):this.$container.removeClass("ps-lightbox-simple"),this.$prev.hide(),this.$next.hide(),this.$container.show(),this.resetHeight(),this.options.simple&&this.setHeight();var t=r(window);t.off("resize.ps-lightbox"),this.options.simple&&t.on("resize.ps-lightbox",r.proxy(this.setHeight,this)),r(document.body).off("keyup.ps-lightbox").on("keyup.ps-lightbox",r.proxy(function(t){27===t.keyCode&&this.close()},this))},open:function(t,e){if(this.data=t||[],this.options=e||{},this.index=e.index||0,this.init(),!this.options.simple){var i=r('\n\t\t\t\t<div style="overflow:hidden; visibility:hidden; position:relative; height:100%;">\n\t\t\t\t\t<div style="overflow: hidden; position: relative; height:100%;"></div>\n\t\t\t\t</div>\n\t\t\t');_.each(this.data,function(t,e){i.children().append('\n\t\t\t\t\t<div class="ps-js-item" data-spinner="1" style="float:left; width:100%; position:relative; height:100%; color:white;">\n\t\t\t\t\t\t<div class="ps-lightbox-spinner" style="display:block;"></div>\n\t\t\t\t\t</div>\n\t\t\t\t')}),this.$object.empty(),this.$object.append(i),this.mySwipe=s(i[0],{draggable:!0,startSlide:this.index,callback:r.proxy(function(t,e){this.go(t)},this)})}this.togglenav(),this.go(this.index),this.hideAttachment();var n=r("body"),o=r("html, body");this.isIOS()?(n.data("ps-scrolltop",n.scrollTop()),o.css({position:"fixed"})):o.addClass("ps-lightbox--open")},close:function(t){if(this.$container){this.$container.hide(),this.$object.empty(),this.$attachment.empty(),this.isMobile()&&this.vpValue&&(this.$viewport.attr("content",this.vpValue),this.vpValue=!1),r(window).off("resize.ps-lightbox"),r(document.body).off("keyup.ps-lightbox");var e=r("body"),i=r("html, body");this.isIOS()?(i.css({position:""}),e.scrollTop(e.data("ps-scrolltop"))):i.removeClass("ps-lightbox--open")}},go:function(t){var e,i,n;if("function"==typeof this.options.beforechange&&this.options.beforechange(this),this.data[t])if(this.data[this.index]&&(e=r.trim(this.$attachment.html()))&&(this.data[this.index].attachment=e),this.index=t,this.$attachment.html(this.data[this.index].attachment||""),this.options.simple)this.$object.html(this.data[this.index].content),(i=this.$object.find("img")).length&&(this.showLoading(),this.$close.hide(),i.on("load",r.proxy(function(){this.hideLoading(),this.$close.show(),this.resetHeight(),this.setHeight.apply(this)},this)),n=i.attr("src").replace("/thumbs/","/").replace(/_(l|m_s|s_s)\./,"."),this.$imagelink.find("a").attr("href",n)),this.options.nofulllink?this.$imagelink.hide():this.$imagelink.show();else{var o=this.$object.find(".ps-js-item").eq(this.index);if(2===this.mySwipe.getNumSlides()&&(o=o.add(this.$object.find(".ps-js-item").eq(this.index+2))),o.data("spinner")){o.removeData("spinner"),o.removeAttr("data-spinner");var s=this.data[this.index].content,a=r("<div />").append(s).children("img");a.length?(0,p.default)(a[0],function(){o.html(s)}):o.html(s)}}"function"==typeof this.options.afterchange&&this.options.afterchange(this),r(document).trigger("ps_lightbox_navigate")},prev:function(){this.mySwipe.prev()},next:function(){this.mySwipe.next()},togglenav:function(){var t=this.$prev.add(this.$next);this.$container.off("click.ps-lightbox",".ps-lightbox-arrow-prev"),this.$container.off("click.ps-lightbox",".ps-lightbox-arrow-next"),r(window).off("keyup.ps-lightbox"),this.options.nonav||!this.data.length||this.data.length<=1?t.hide():(t.show(),this.$container.on("click.ps-lightbox",".ps-lightbox-arrow-prev",r.proxy(this.prev,this)),this.$container.on("click.ps-lightbox",".ps-lightbox-arrow-next",r.proxy(this.next,this)),r(window).on("keyup.ps-lightbox",r.proxy(function(t){var e=t.keyCode;37===e?this.prev():39===e&&this.next()},this)))},isAttachmentOpened:function(){return this.$attachment.hasClass(t)},showAttachment:function(){this.$attachment.addClass(t),this.$close.addClass(i)},hideAttachment:function(){this.$attachment.removeClass(t),this.$close.removeClass(i)},showLoading:function(){this.$object.hide(),this.$spinner.show()},hideLoading:function(){this.$spinner.hide(),this.$object.show()},attachevents:function(){this.$container.on("click.ps-lightbox",".ps-lightbox-padding",r.proxy(function(t){t.target===t.currentTarget&&(t.stopPropagation(),this.close())},this)),this.$btnattachment.on("click",r.proxy(function(){this.isAttachmentOpened()?this.hideAttachment():this.showAttachment()},this)),this.$close.on("click",r.proxy(function(){this.isAttachmentOpened()?this.hideAttachment():this.close()},this)),this.$imagelink.on("click","a",r.proxy(function(){this.close()},this)),this.$attachment.on("keyup.ps-lightbox",function(t){t.stopPropagation()})},isMobile:function(){var t=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent);return this.isMobile=t?function(){return!0}:function(){return!1},t},isIOS:function(){return!!/iphone|ipad|ipod/i.test(navigator.userAgent)},resetHeight:function(){this.$object.find("img").css("maxHeight","")},setHeight:_.debounce(function(){this.$object.find("img").css("maxHeight",this.$wrapper.height())},100)},n}(jQuery||$,o.default)),peepso.lightbox=function(t,e){"close"!==t?"function"==typeof t?(n.options=e||{},n.init(),n.showLoading(),t(function(t,e){n.hideLoading(),n.open(t,e||{})})):n.open(t,e||{}):n.close()},peepso.simple_lightbox=function(t){peepso.lightbox([{content:'<div style="display:inline-block;"><img src="'+t+'" /></div>'}],{simple:!0})}},{imagesloaded:21,swipejs:22}],5:[function(o,t,e){(function(t){"use strict";var e=n("undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null),i=n(o("./popover"));function n(t){return t&&t.__esModule?t:{default:t}}(0,e.default)(function(t){t(".ps-js-notifications").each(function(){new i.default(this)})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./popover":6}],6:[function(l,t,f){(function(t){"use strict";Object.defineProperty(f,"__esModule",{value:!0});var e=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),n=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},p=s("undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null),i=(s("undefined"!=typeof window?window.peepso:void 0!==t?t.peepso:null),s(l("./singleton"))),o=s(l("../notification-popover"));function s(t){return t&&t.__esModule?t:{default:t}}var a=peepsodata.mark_all_as_read_text,r=peepsodata.mark_all_as_read_confirm_text,h=peepsodata.show_unread_only_text,u=peepsodata.show_all_text,c=new i.default,d=function(t){function i(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.loading=!1,e.loadEnd=!1,c.on("counter:updated",function(t){e.updateCounter(t)}),c.on("html:updated",function(t){e.updateHtml(t)}),c.on("unread_only:updated",function(t){e.updateButton(t)}),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,o.default),e(i,[{key:"createBody",value:function(){var e=this;return n(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"createBody",this).call(this).on("mousedown",".ps-js-notification",function(t){e.onItemClick(t)}).on("click",".ps-js-mark-as-read",function(t){e.onMarkRead(t)}).on("click",".ps-js-notification a",function(t){t.stopPropagation()}).on("mousedown",".ps-js-mark-as-read",function(t){t.stopPropagation()})}},{key:"createFooter",value:function(){var e=this;return this.$btnMarkAllRead=(0,p.default)('<a href="#">'+a+"</a>").css({float:"left",width:"50%"}).on("click",function(t){e.onMarkAllRead(t)}),this.$btnToggleUnreadOnly=(0,p.default)('<a href="#">'+h+"</a>").css({float:"left",width:"50%"}).on("click",function(t){e.onToggleUnreadOnly(t)}),(0,p.default)('<div class="ps-popover-footer app-box-footer ps-clearfix"></div>').append(this.$btnMarkAllRead).append(this.$btnToggleUnreadOnly)}},{key:"updateCounter",value:function(t){var e=this.$counter;0<t?e.text(t).show():e.hide()}},{key:"updateHtml",value:function(t){this.html!==t&&(this.html=t,this.$popoverBody.html(t),(0,p.default)(document.body).hasClass("wp-admin")&&this.$popoverBody.find("a[href]").attr("target","_blank"))}},{key:"updateButton",value:function(t){var e=this.$btnToggleUnreadOnly,i=t?u:h;this.loadEnd=!1,e.html(i)}},{key:"toggle",value:function(t){if(n(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toggle",this).call(this,t),!this.html){var e=+this.$counter.text()||0;c.unreadCount=e,c.fetch(1)}}},{key:"loadNext",value:function(){var t=this,e=void 0,i=void 0;this.loading||this.loadEnd||(this.loading=!0,e=this.$popoverLoading,(i=this.$popoverBody.append(e))[0].scrollTop=i[0].scrollHeight,c.next().catch(function(){t.loadEnd=!0}).then(function(){t.loading=!1,e.detach(),t.loadEnd||t.tryLoadNext()}))}},{key:"onItemClick",value:function(t){var e=(0,p.default)(t.currentTarget),i=e.data("id"),n=e.data("unread"),o="ps-notification--unread",s=void 0,a=void 0,r=void 0;t.stopPropagation(),!n||3===t.which||t.ctrlKey||t.altKey||(("_blank"===(s=e.find("a").eq(0)).attr("target")||2===t.which||t.metaKey||t.shiftKey)&&(r=!0),r||s.on("click",function(t){t.preventDefault(),t.stopPropagation()}),e.data("progress")||(e.data("progress",!0).css("opacity",.5),e.removeClass(o),a=e.find(".ps-js-mark-as-read").hide(),c.markRead(i).then(function(){e.data("unread",!1),a.remove(),r||(s.off("click"),s[0].click(),setTimeout(function(){window.location=s.attr("href")},1))}).catch(function(){e.addClass(o),a.show()}).then(function(){e.data("progress",!1).css("opacity","")})))}},{key:"onMarkRead",value:function(t){var e=(0,p.default)(t.currentTarget),i=e.closest(".ps-js-notification"),n=i.data("id"),o="ps-notification--unread";t.preventDefault(),t.stopPropagation(),i.data("progress")||(i.data("progress",!0).css("opacity",.5),i.removeClass(o),e.hide(),c.markRead(n).then(function(){i.data("unread",!1),e.remove()}).catch(function(){i.addClass(o),e.show()}).then(function(){i.data("progress",!1).css("opacity","")}))}},{key:"onMarkAllRead",value:function(t){var e=this,i=this.$btnMarkAllRead;t.preventDefault(),t.stopPropagation(),i.data("progress")||confirm(r)&&(i.data("progress",!0).css("opacity",.5),c.markRead().then(function(){e.toggle()}).catch(p.default.noop).then(function(){i.data("progress",!1).css("opacity","")}))}},{key:"onToggleUnreadOnly",value:function(t){var e=this,i=this.$btnToggleUnreadOnly;t.preventDefault(),t.stopPropagation(),i.data("progress")||(this.$popoverBody.empty().append(this.$popoverLoading),i.data("progress",!0).css("opacity",.5),c.toggleUnreadOnly().catch(p.default.noop).then(function(){i.data("progress",!1).css("opacity",""),e.tryLoadNext()}))}}]),i}();f.default=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../notification-popover":8,"./singleton":7}],7:[function(t,e,h){(function(t){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var e=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=i("undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null),n="undefined"!=typeof window?window.peepso:void 0!==t?t.peepso:null,r=i(n);function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var s=void 0,p=function(t){function i(){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),!s){var e=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));(s=e).notifications=[""],e.unreadCount=null,e.params={page:1,per_page:5,unread_only:0},e.fetchEnd=!1,n.observer.addAction("notification_update",function(t){e.doUpdate(t)},10,1)}return o(e,s)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,r.default.npm.EventEmitter),e(i,[{key:"doUpdate",value:function(t){var e=void 0;t&&t.data&&(e=+(t.data["ps-js-notifications"]||{}).count,_.isNaN(e)||this.unreadCount===e||(this.unreadCount=e,this.emit("counter:updated",e),this.reset()))}},{key:"reset",value:function(){var e=this;return new Promise(function(t){e.notifications=[""],e.params.page=1,e.fetchEnd=!1,e.fetch().catch(a.default.noop).then(function(){t()})})}},{key:"fetch",value:function(){var n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,o=_.extend({},this.params,{page:t||this.params.page}),e=void 0,s=void 0;return(e=new Promise(function(e,i){n.fetchEnd?e([]):r.default.getJson("notificationsajax.get_latest",o,function(t){t.success?(s=t.data||{},e(s.notifications||[])):t.errors&&1===o.page?i(t.errors):e([])})})).then(function(t){_.isArray(t)&&t.length?n.notifications[o.page]=t:n.fetchEnd=!0}).catch(function(t){n.fetchEnd=!0,n.params.page=1,n.notifications=["",['<div class="ps-notification">','<a class="ps-notification__inside">','<div class="ps-notification__desc">',t.join("<br />"),"</div>","</a>","</div>"].join("")]}).then(function(){n.emit("html:updated",n.html)}),e}},{key:"next",value:function(){var n=this;return new Promise(function(t,e){var i=n.params.page+1;n.fetchEnd?e():n.fetch(i).then(function(){n.params.page=i,t()})})}},{key:"markRead",value:function(){var n=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return new Promise(function(e,i){var t=o?{note_id:o}:null;r.default.postJson("notificationsajax.mark_as_read",t,function(t){t.success?(n.unreadCount=o?Math.max(n.unreadCount-1,0):0,n.notifications=n.__markHtmlAsRead(n.notifications,o),n.emit("counter:updated",n.unreadCount),n.emit("html:updated",n.html),e()):i()})})}},{key:"toggleUnreadOnly",value:function(){var n=this;return new Promise(function(t,e){var i=n.params.unread_only;i=i?0:1,n.params.unread_only=i,n.reset().then(function(){n.emit("unread_only:updated",i),t()})})}},{key:"__markHtmlAsRead",value:function(t){var n=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,s="ps-js-notification";return _.map(t,function(t){if(_.isArray(t))t=n.__markHtmlAsRead(t,o);else if(_.isString(t)&&t.length){var e=(0,a.default)("<div/>").html(t),i=e.find("."+s);o&&(i=i.filter("."+s+"--"+o)),i.removeClass("ps-notification--unread").removeAttr("data-unread"),i.find(".ps-js-mark-as-read").remove(),t=e.html()}return t},this)}},{key:"html",get:function(){return _.flatten(this.notifications).join("")}}]),i}();h.default=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(t,e,r){(function(t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e,n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,o=(e=i)&&e.__esModule?e:{default:e};var s=peepsodata.loading_gif,a=function(){function i(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.guid=_.uniqueId("psNotificationPopover_"),this.$elem=(0,o.default)(t),this.$counter=this.$elem.find(".ps-js-counter"),this.$popover=null,this.$popoverBody=null,this.$popoverFooter=null,this.$popoverLoading=null,this.$elem.on("click",function(t){e.toggle(t)}),this.render()}return n(i,[{key:"render",value:function(){this.$popover||(this.$popoverBody=this.createBody(),this.$popoverFooter=this.createFooter(),this.$popoverLoading=(0,o.default)('<div class="ps-popover-loading" style="padding:5px 0" />').append('<img src="'+s+'" />').appendTo(this.$popoverBody),this.$popover=(0,o.default)('<div class="ps-popover app-box" />').append(this.$popoverBody).append(this.$popoverFooter).hide(),this.$elem.append(this.$popover))}},{key:"createBody",value:function(){var e=this;return(0,o.default)('<div class="ps-notifications" />').css({maxHeight:"40vh",overflow:"auto"}).on("wheel",function(t){e.disableParentScroll(t)}).on("scroll",function(t){e.handleScroll(t)})}},{key:"createFooter",value:function(){return(0,o.default)()}},{key:"toggle",value:function(t){var e=this,i="click."+this.guid;if(t&&t.preventDefault(),this.$popover||this.render(),this.$popover.is(":visible"))return(0,o.default)(document).off(i),void this.$popover.stop().slideUp("fast");_.defer(function(){e.$popover.stop().slideDown({duration:"fast",start:function(){e.$popover.position({my:"right top",at:"right bottom",of:e.$elem,collision:"flip"})},done:function(){(0,o.default)(document).one(i,function(t){e.$popover.hide()}),e.tryLoadNext()}})})}},{key:"tryLoadNext",value:function(){var t=this.$popoverBody[0],e=t.scrollTop,i=t.scrollHeight-t.clientHeight;Math.abs(e-i)<=1&&this.loadNext()}},{key:"loadNext",value:function(){}},{key:"disableParentScroll",value:function(t){var e,i=t.currentTarget,n=i.scrollTop,o=t.originalEvent.deltaY;0===n&&o<0?(t.preventDefault(),t.stopPropagation()):(e=i.scrollHeight-i.clientHeight,Math.abs(n-e)<=1&&0<o&&(t.preventDefault(),t.stopPropagation()))}},{key:"handleScroll",value:function(){this.tryLoadNext()}}]),i}();r.default=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(t,e,i){"use strict";var n,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function s(){this.can_submit=!1,this.found_url=!1,this.show_preview=!0,this.$postbox=null,this.$url_preview_container=jQuery("<div class='url-preview-container'></div>")}(n=jQuery).fn.pspostbox=function(t){if(!(this.length<=0)){var i=this;return this.$textarea=null,this.$access=null,this.$charcount=null,this.$save_button=null,this.$posttabs=null,this.$privacy_dropdown=null,this.can_submit=!1,this.init=function(t){var i=this,e={textarea:"textarea.ps-postbox-textarea",mirror:".ps-postbox-mirror",addons:".ps-postbox-addons",access:"#postbox_acc",save_url:"postbox.post",charcount:".post-charcount",save_button:".postbox-submit",send_button_text:void 0,text_length:peepsodata.postsize,autosize:!0};this.opts=e,n.extend(!0,this.opts,t),this.guid=_.uniqueId("postbox-"),this.$posttabs=n(this).find(".ps-postbox-tab-root").ps_posttabs({container:this}),this.$textarea=jQuery(this.opts.textarea,this),this.$mirror=jQuery(this.opts.mirror,this),this.$addons=jQuery(this.opts.addons,this),this.$access=n(this.opts.access,this),this._default_access=this.$access.val(),this.$charcount=n(this.opts.charcount,this),this.$save_button=n(this.opts.save_button,this),_.isUndefined(this.opts.send_button_text)||this.$save_button.html(this.opts.send_button_text),this.$privacy=n("#privacy-tab",this),this.orig_height=this.$textarea.height(),this.opts.autosize&&this.$textarea.autosize(),this.$textarea.attr("maxlength",this.opts.text_length).on("keydown",function(t){i.on_keydown(t)}).on("keypress",function(t){i.on_keypress(t)}).on("paste",function(t){i.on_paste(t)}).on("focus",function(t){i.on_focus()}).on("keyup",function(t){i.on_change()}).on("input",function(t){i.on_input()}),this.$charcount.html(this.opts.text_length+""),this.$privacy_dropdown=n(".ps-privacy-dropdown",this.$privacy),this.$privacy_dropdown.on("click a",jQuery.proxy(function(t){var e=jQuery(t.target).closest("a"),i=this.$privacy.find(".interaction-icon-wrapper .pstd-secondary"),n=jQuery("#postbox_acc");t.stopPropagation(),i.find("i").attr("class",e.find("i").attr("class")),i.find("span").html(e.find("span").text()),n.val(e.attr("data-option-value")),this.$privacy_dropdown.hide()},this)),this.$privacy.on("click",function(t){i.privacy(t)}),jQuery("nav.ps-postbox-tab ul li a").click(this.clear_tabs),jQuery("#status-post",i).hide(),jQuery(this.$posttabs).on("peepso_posttabs_show-status",function(){jQuery("#status-post",i).hide(),jQuery(".ps-postbox-status").show()}),jQuery("#status-post",i).on("click",function(){jQuery(i.$posttabs).find("[data-tab='status']").trigger("click")}),this.$posttabs.on("peepso_posttabs_submit-status",function(){i.save_post()}),this.$posttabs.on("peepso_posttabs_cancel-status",function(){jQuery("#status-post",i).show()}),this.$posttabs.on("peepso_posttabs_submit",function(){i.$textarea.val("")}),this.$posttabs.on("peepso_posttabs_cancel",function(){i.$textarea.val(""),i.cancel_post()}),this.find(".interactions > ul > li > .interaction-icon-wrapper a").on("click",function(t,e){e||i.find(".interactions > ul > li > .interaction-icon-wrapper a").not(this).trigger("peepso.interaction-hide",[!0])}),this._load_addons()},this._load_addons=function(){var t=ps_observer.apply_filters("peepso_postbox_addons",[]);n(t).each(function(t,e){e.set_postbox(i),e.init()})},this.clear_tabs=function(){ps_observer.apply_filters("postbox_clear_tabs",null)},this.privacy=function(t){var e=this;this.$privacy_dropdown.show(),jQuery(document).on("mouseup.postbox-privacy",function(t){e.$privacy_dropdown.is(t.target)||0!==e.$privacy_dropdown.has(t.target).length||(e.$privacy_dropdown.hide(),jQuery(document).off("mouseup.postbox-privacy"))})},this.save_post=function(){var t={content:this.$textarea.val(),id:peepsodata.currentuserid,uid:peepsodata.userid,acc:this.$access.val(),type:"activity"};_.isUndefined(this.opts.postbox_req)||("undefined"==typeof Function?"undefined":o(Function))!==o(this.opts.postbox_req)||(t=this.opts.postbox_req.apply(null,[t])),t=ps_observer.apply_filters("postbox_req",t),t=ps_observer.apply_filters("postbox_req_"+this.guid,t),this.save_post_queue||(this.save_post_queue=[]),this.save_post_queue.push(t),this.on_before_save(),this.save_post_progress||(this.save_post_progress=!0,this.save_post_execute())},this.save_post_execute=function(){if(!this.save_post_queue.length)return ps_observer.apply_filters("peepso_postbox_enter_to_send",!1)||(jQuery(".ps-postbox-loading",this).hide(),jQuery(".ps-postbox-action",this).css("display","flex"),this.$posttabs.on_cancel()),this.save_post_progress=!1,this.on_queue_clear(),void postbox.remove_broken_thumbnails();var e=this.save_post_queue.shift();ps_observer.apply_filters("peepso_postbox_enter_to_send",!1)||(jQuery(".ps-postbox-action",this).css("display","none"),jQuery(".ps-postbox-loading",this).show()),$PeepSo.disableAsync().postJson(this.opts.save_url,e,function(t){t.success?(i.on_save(t),jQuery(i).trigger("postbox.post_saved",[e,t])):i.on_error(t),i.save_post_execute()})},this.on_before_save=function(){("undefined"==typeof Function?"undefined":o(Function))===o(this.opts.on_before_save)&&this.opts.on_before_save.apply(this)},this.on_save=function(t){("undefined"==typeof Function?"undefined":o(Function))===o(this.opts.on_save)&&this.opts.on_save.apply(this,[t]),this.$textarea.css("height",this.orig_height),jQuery(this).trigger("postbox.post_saved",this)},this.on_queue_clear=function(){("undefined"==typeof Function?"undefined":o(Function))===o(this.opts.on_queue_clear)&&this.opts.on_queue_clear.apply(this)},this.on_error=function(t){("undefined"==typeof Function?"undefined":o(Function))===o(this.opts.on_error)?this.opts.on_error.apply(this,[t]):!1===_.isUndefined(t.errors[0])&&psmessage.show("Error",t.errors[0])},this.cancel_post=function(){this.$textarea.css("height",this.orig_height),this.on_change(),jQuery(this).trigger("postbox.post_cancel")},this.on_focus=function(){jQuery(".ps-postbox-tab-root",i).hide(),jQuery(".ps-postbox-tab.interactions",i).attr("data-tab-shown",this.$posttabs.current_tab().data("tab")),jQuery(".ps-postbox-tab.interactions",i).show()},this.on_keydown=function(t){if(this._go_submit=!1,13!==t.keyCode)return!0;var e=this.$textarea.val(),i=jQuery.trim(e);return!t.shiftKey&&ps_observer.apply_filters("peepso_postbox_enter_to_send",!1)&&(i.length||this.submitable(e))?(t.preventDefault(),this._go_submit=!0,this.$posttabs.on_submit(),!1):i.length?void 0:(t.preventDefault(),!1)},this.on_keypress=function(t){if(this.$textarea.val()>=this.opts.text_length)return!1},this.on_paste=function(t){var e=this;t.originalEvent.clipboardData.getData("text/plain").slice(0,this.text_length),setTimeout(function(){e.on_change()},100)},this.on_input=function(t){this._go_submit||(ps_observer.apply_filters("peepso_postbox_input_changed",this.$textarea.val()),this.update_beautifier())},this.on_change=function(){var t=this.$textarea.val(),e=t.length;(e=this.opts.text_length-e)<0&&(e=0),this.$charcount.html(e+""),50<=e?this.$charcount.removeClass("alert-info").removeClass("alert-error"):0===e?pswindow.show("","You may only enter up to "+this.opts.text_length+" characters"):e<30?this.$charcount.removeClass("alert-info").addClass("alert-error"):e<50&&this.$charcount.addClass("alert-info").removeClass("alert-error"),this.submitable(t)&&!ps_observer.apply_filters("peepso_postbox_enter_to_send",!1)?this.$save_button.show():this.$save_button.hide();var i=t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");this.$mirror.html(i),this.addons_update()},this.submitable=function(t){var e=Math.max(0,this.opts.text_length-t.length),i=ps_observer.apply_filters("peepso_postbox_can_submit",{hard:[],soft:[e<this.opts.text_length&&""!==jQuery.trim(t)]});return i=i.hard.length?!(-1<i.hard.indexOf(!1)):-1<i.soft.indexOf(!0)},this.addons_update=jQuery.proxy(_.debounce(function(){var t=ps_observer.apply_filters("peepso_postbox_addons_update",[]);if(t&&t.length){var e=this.$textarea.attr("placeholder");this.$textarea.data("placeholder",e).removeAttr("placeholder"),this.$addons.html("&mdash; "+t.join(" and ")),this.$addons.show()}else e=this.$textarea.data("placeholder"),this.$textarea.attr("placeholder",e),this.$addons.hide().empty()},10),this),this.update_beautifier=_.throttle(function(){_.defer(_.bind(function(){var t,e;this.$beautifier||(this.$textarea.addClass("ps-tagging-textarea"),(t=this.$textarea.parent(".ps-tagging-wrapper")).length||(this.$textarea.wrap("<div class=ps-tagging-wrapper />"),t=this.$textarea.parent(".ps-tagging-wrapper")),this.$beautifier=t.children(".ps-tagging-beautifier"),this.$beautifier.length||(this.$beautifier=n("<div class=ps-tagging-beautifier />"),this.$beautifier.prependTo(t)),this.$textarea.focus()),e=this.$textarea.val()||"",e=(e=peepso.observer.applyFilters("peepso_postbox_beautifier",e,this.$textarea)).replace(/<(?!\/?ps_)/g,"&lt;").replace(/<(\/?)ps_/g,"<$1").replace(/\r?\n/g,"<br />"),this.$beautifier.html(e)},this))},100),this.init(t),this}},s.prototype.init=function(){var e=this;return ps_observer.add_filter("peepso_postbox_can_submit",function(t){return t||e.can_submit},20,1),this.$activity_stream_recent=jQuery("#ps-activitystream-recent"),this.$activity_stream=jQuery("#ps-activitystream"),this.$postbox=jQuery("#postbox-main").pspostbox({postbox_req:function(t){return t.show_preview=e.show_preview?"1":"0",t},on_save:function(t){return jQuery(this.$posttabs).find("[data-tab='status']").trigger("click"),e.append_to_stream(t)}}),void 0!==this.$postbox&&(this.$postbox.$textarea.on("blur",function(t){e.check_url_preview()}).on("keyup",function(t){32===t.keyCode&&e.check_url_preview()}),this.$postbox.on("postbox.post_saved postbox.post_cancel",function(){e.found_url=!1,e.show_preview=!0,e.can_submit=!1,e.$url_preview_container.empty().remove()})),this.$postbox},s.prototype.check_url_preview=function(){if("status"===this.$postbox.$posttabs.current_tab().data("tab")&&!this.found_url){var e=this,t=this.$postbox.$textarea.val().match(/((https?:\/\/|www\.)([a-z0-9-]+\.)+[a-z]{2,24}(:\d+)?(\/.*)?)/gi),i=t&&t[0],n=+peepsodata.allow_non_ssl_embed;if(i&&(i.match(/^https:\/\//i)||n)&&!this.fetch_url){this.fetch_url=i;var o=this.$postbox.$textarea.closest(".ps-postbox-input");jQuery(".ps-postbox-loading",this.$postbox).show(),jQuery(".ps-postbox-action",this.$postbox).css("display","none");var s={url:i};peepso.postJson("postbox.get_url_preview",s,function(t){e.fetch_url=!1,jQuery(".ps-postbox-loading",e.$postbox).hide(),jQuery(".ps-postbox-action",e.$postbox).css("display","flex"),t.success&&(0===jQuery(o).find(".url-preview-container").length&&(/firefox/i.test(navigator.userAgent)&&/iframe/i.test(t.data.html)&&/secret=/.test(t.data.html)&&(t.data.html=t.data.html.replace(/display\s*:\s*none/,"")),e.$url_preview_container.html(t.data.html),jQuery(o).append(e.$url_preview_container),e.$url_preview_container.find(".remove-preview").on("click",function(t){e.show_preview=!1,t.preventDefault(),e.$url_preview_container.empty().remove(),e.can_submit=!1}),e.remove_broken_thumbnails(),peepso.util.fbParseXFBML()),e.found_url=!0,e.can_submit=!0,e.$postbox.on_change())})}}},s.prototype.append_to_stream=function(t){0<jQuery("#ps-no-posts").length&&(jQuery(this.$activity_stream.css("display","block")),jQuery("#ps-no-posts").remove());var e=t.data.post_id,i=peepso.observer.applyFilters("peepso_activity_content",t.data.html);this.$activity_stream_recent.show(),jQuery(i).hide().prependTo(this.$activity_stream_recent).fadeIn("slow",function(){jQuery(this).find(".comment-container").hide(),jQuery(document).trigger("ps_activitystream_append",[jQuery("#peepso-wrap .ps-js-activity--"+e+" .ps-js-dropdown-toggle")])}),ps_observer.apply_filters("peepso_posttabs_cancel-status")},s.prototype.remove_broken_thumbnails=function(){jQuery(".ps-media-thumbnail img").each(function(){var t=new Image,e=this;t.onerror=function(){jQuery(e).closest(".ps-media-thumbnail").remove()},t.src=e.src})},window.postbox=new s,jQuery(document).ready(function(){postbox.init()}),jQuery(function(){if(jQuery.support.placeholder=!1,"placeholder"in document.createElement("input")&&(jQuery.support.placeholder=!0),!jQuery.support.placeholder){var t=document.activeElement;jQuery("textarea").focus(function(){jQuery(this).attr("placeholder")&&0<jQuery(this).attr("placeholder").length&&""!==jQuery(this).attr("placeholder")&&jQuery(this).val()===jQuery(this).attr("placeholder")&&jQuery(this).val("").removeClass("hasPlaceholder")}).blur(function(){jQuery(this).attr("placeholder")&&0<jQuery(this).attr("placeholder").length&&""!==jQuery(this).attr("placeholder")&&(""===jQuery(this).val()||jQuery(this).val()===jQuery(this).attr("placeholder"))&&jQuery(this).val(jQuery(this).attr("placeholder")).addClass("hasPlaceholder")}),jQuery("textarea").blur(),jQuery(t).focus(),jQuery("form").submit(function(){jQuery(this).find(".hasPlaceholder").each(function(){jQuery(this).val("")})})}})},{}],10:[function(t,e,i){"use strict";var o,s;o=jQuery,s=function(t,n){function e(){this.__constructor.apply(this,arguments)}return peepso.npm.objectAssign(e.prototype,PsObserver.prototype,{__constructor:function(t,e){var i=peepso.template(psdata_postbox.template);this.$el=n(t).html(i),this.$text=this.$el.find("textarea").ps_autosize(),this.$loading=this.$el.find(".ps-postbox-loading"),this.$btns=this.$el.find(".ps-postbox-action"),this.$btnCancel=this.$btns.find(".ps-button-cancel"),this.$btnSubmit=this.$btns.find(".ps-button-action"),this.$charCounter=this.$el.find(".ps-postbox-charcount"),this.$tabRoot=this.$el.find("div.ps-postbox-tab-root"),this.$tabContext=this.$el.find("nav.ps-postbox-tab"),this.$addons=this.$el.find(".ps-postbox-addons"),this.opts=n.extend({maxChars:+psdata_postbox.max_chars||4e3,fetch:!1,cancel:!1,submit:!1},e||{}),this.init()},init:function(){this.$text.val(""),this.updateButtonVisibility(),this.updateCharCounter(),this.add_action("refresh",this.refresh,10,1,this),this.$tabContext.find("#privacy-tab").remove(),this.$tabContext.find("#status-post").remove(),ps_observer.do_action("postbox_init",this),this.fetch().done(function(){this.$text.on("focus.ps-postbox",n.proxy(this.onFocus,this)),this.$text.on("input.ps-postbox",n.proxy(this.onInput,this)),this.$btnSubmit.on("click.ps-postbox",n.proxy(this.onSubmit,this)),this.$btnCancel.on("click.ps-postbox",n.proxy(this.onCancel,this)),this.$tabRoot.on("click.ps-postbox","li[data-tab]",n.proxy(this.onTabChange,this))})},fetch:function(){return n.Deferred(n.proxy(function(t){"function"==typeof this.opts.fetch?(this.$btns.hide(),this.$loading.show(),this.opts.fetch(this,n.proxy(function(){this.$loading.hide(),this.$btns.css("display","flex"),t.resolveWith(this)},this))):t.resolveWith(this)},this))},update:function(t){this.$text.val(t.content||"").trigger("input"),this.updateButtonVisibility(),this.updateCharCounter(),this.do_action("update",t),ps_observer.do_action("postbox_update",this,t)},reset:function(){this.$text.val(""),this.updateButtonVisibility(),this.updateCharCounter(),this.do_action("reset"),ps_observer.do_action("postbox_reset",this)},refresh:function(){this.renderAddons(),this.updateButtonVisibility(),this.updateCharCounter()},_getData:function(){return{content:this.$text.val()}},getData:function(){var t=this._getData();return t=this.apply_filters("data",t),t=ps_observer.apply_filters("postbox_data",t,this)},tabChange:function(t){var e=this.$tabRoot.find("li[data-tab]"),i=e.filter('[data-tab="'+t+'"]');i.length&&(e.not(i).removeClass("active"),i.addClass("active"),this.currentTab=t)},getActiveTab:function(){return this.currentTab||(this.currentTab=this.$tabRoot.find("li.active").data("tab")),this.currentTab},validate:function(){var t=this._getData(),e=!!n.trim(t.content);return this.apply_filters("data_validate",e,t)},submit:function(){"function"==typeof this.opts.submit&&this.validate()&&(this.$btns.hide(),this.$loading.show(),this.opts.submit(this,this.getData(),n.proxy(function(){this.$loading.hide(),this.$btns.css("display","flex")},this)))},cancel:function(){this.reset(),this.$tabContext.hide(),this.$tabRoot.show(),"function"==typeof this.opts.cancel&&this.opts.cancel(this)},updateCharCounter:_.throttle(function(){var t=this.$text.val().length,e=Math.max(0,this.opts.maxChars-t);this.$charCounter.html(e)},250),updateButtonVisibility:_.throttle(function(){this.validate()?this.$btnSubmit.show():this.$btnSubmit.hide()},250),renderAddons:_.throttle(function(){var t=this.apply_filters("render_addons",[]).join(" and ");t&&(t="&mdash; "+t),this.$addons.html(t)},250),destroy:function(){this.$el.empty()},onFocus:function(){this.$tabRoot.hide(),this.$tabContext.show()},onInput:function(){this.updateButtonVisibility(),this.updateCharCounter()},onCancel:function(){this.cancel()},onSubmit:function(){this.submit()},onTabChange:function(t){var e=n(t.currentTarget).data("tab");this.tabChange(e)}}),e}(0,o),o.fn.ps_postbox=function(i,n){return this.each(function(){var t=o(this),e=t.data("ps-postbox");e&&"string"==typeof i?(e[i].call(e,n),"destroy"===i&&t.removeData("ps-postbox")):e||(e=new s(t,i||{}),t.data("ps-postbox",e))})}},{}],11:[function(t,e,i){"use strict";var o;(o=jQuery).fn.ps_posttabs=function(t){return this._tabs=null,this._tabs_div={},this.tab_objects={},this.orig_html={},this.options={container:this},this.init=function(t){var i=this;o.extend(!0,this.options,t),o("[data-tab-id]",this.options.container).each(function(t,e){i._tabs_div[o(e).data("tab-id")]=o(e)}),this._tabs=this.find("[data-tab]"),this._tabs.on("click",function(t){var e=o(t.currentTarget);i.current_tab_id=e.data("tab"),i.show_tab(e)}).first().trigger("click"),jQuery(this.options.container).on("click",".ps-postbox-tab.interactions .ps-button-cancel",function(){i.on_cancel()}),jQuery(this.options.container).on("click",".ps-postbox-tab.interactions .postbox-submit",function(){i.on_submit()})},this.show_tab=function(t){var e=this.current_tab();e.removeClass("active");var i=this.get_tab(e.data("tab"));i.hide(),o(this).trigger("peepso_posttabs_cancel-"+e.data("tab"),[i,this]),o(t).addClass("active");var n=this.get_tab(o(t).data("tab"));o(this).trigger("peepso_posttabs_show-"+o(t).data("tab"),[n,this])},this.current_tab=function(){return o("[data-tab]",this.options.container).filter(".active")},this.get_tab=function(t){return _.isUndefined(this._tabs_div[t])?o(""):this._tabs_div[t]},this.on_submit=function(){var t=this.current_tab();ps_observer.apply_filters("peepso_posttabs_submit-"+t.data("tab")),o(this).trigger("peepso_posttabs_submit-"+t.data("tab")),o(this).trigger("peepso_posttabs_submit",[t,this])},this.on_cancel=function(){var t=this.current_tab();jQuery(".ps-postbox-tab-root",this.options.container).show(),jQuery(".ps-postbox-tab.interactions",this.options.container).hide(),o(this).trigger("peepso_posttabs_cancel-"+t.data("tab"),[t,this]),o(this).trigger("peepso_posttabs_cancel",[t,this]),t.trigger("click")},this.init(t),this}},{}],12:[function(t,e,i){(function(t){"use strict";var e,i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,n=(e=i)&&e.__esModule?e:{default:e};n.default.fn.psSafetyWarning=function(){return this.each(function(t,e){(0,n.default)(e).find(".ps-js-close").on("click",function(t){(0,n.default)(t.target).closest(".ps-js-safety-warning").remove()})})},(0,n.default)(function(){(0,n.default)(".ps-js-safety-warning").psSafetyWarning()})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(t,e,i){"use strict";function n(){}window.share=new n,n.prototype.share_url=function(t){var e,i,n=jQuery("#share-dialog-title").html(),o=jQuery("#share-dialog-content").html();return t=encodeURIComponent(t),e="{peepso-url}",i=t,o=o.replace(new RegExp(e,"g"),i),pswindow.show(n,o),!1}},{}],14:[function(t,e,i){"use strict";jQuery(function(t){var e=t("#peepso-wrap");if(e.length){var i=e.closest(".et_pb_row");i.length&&i.find(".et_pb_column").css({zIndex:"auto"})}})},{}],15:[function(t,e,i){"use strict";var n,o;n=window,o=function(f,n){function v(){return Math.floor((new Date).getTime()/1e3)}function t(){this.ts=v(),this.diff=f.peepsotimedata.ts-this.ts}return t.prototype.human_time_diff=function(t,e){var i,n,o,s,a,r,p,h,u=86400,c=7*u,d=365*u,l=f.peepsotimedata||{};return t=+t,e=e||v(),e+=this.diff,(i=Math.abs(e-t))<60?h=l.now:i<3600?h=(1<(n=(n=Math.round(i/60))<=1?1:n)?l.mins:l.min).replace("%s",n):i<u&&3600<=i?h=(1<(o=(o=Math.round(i/3600))<=1?1:o)?l.hours:l.hour).replace("%s",o):i<c&&u<=i?h=(1<(s=(s=Math.round(i/u))<=1?1:s)?l.days:l.day).replace("%s",s):i<30*u&&c<=i?h=(1<(a=(a=Math.round(i/c))<=1?1:a)?l.weeks:l.week).replace("%s",a):i<d&&30*u<=i?h=(1<(r=(r=Math.round(i/(30*u)))<=1?1:r)?l.months:l.month).replace("%s",r):d<=i&&(h=(1<(p=(p=Math.round(i/d))<=1?1:p)?l.years:l.year).replace("%s",p)),ps_observer.apply_filters("human_time_diff",h,i,t,e)},n(function(){setInterval(function(){var i=v();n(".ps-js-autotime").each(function(){var t=n(this),e=t.data("timestamp");e&&t.html(ps_time.human_time_diff(e,i))})},4e4)}),t}(n,jQuery),n.ps_time=new o},{}],16:[function(t,e,i){"use strict";t("./widgetme"),t("./widget-latest-members"),t("./widget-online-members")},{"./widget-latest-members":17,"./widget-online-members":18,"./widgetme":19}],17:[function(t,e,i){"use strict";var n,p,o;n=jQuery,p=n,o={init:function(){var r="ps-js-initialized",t=p(".ps-js-widget-latest-members").not("."+r);t.each(p.proxy(function(t,e){var i=p(e).addClass(r),n=i.find(".ps-js-widget-content"),o=+i.data("hideempty"),s=+i.data("totalmember"),a=+i.data("limit");this.getData(a,s).done(function(t,e){e&&o?(n.empty(),i.hide()):(n.html(t),i.show())})},this))},getData:function(i,n){return p.Deferred(function(e){var t={};setTimeout(function(){t.limit=+i,t.totalmember=n?1:0,peepso.getJson("widgetajax.latest_members",t,function(t){t.success?e.resolve(t.data.html,+t.data.empty):e.reject()})},3e3)})}},peepso.widget=peepso.widget||{},peepso.widget.latestMembers=o,n(n.proxy(o.init,o))},{}],18:[function(t,e,i){"use strict";var n,p,o;n=jQuery,p=n,o={init:function(){var r="ps-js-initialized",t=p(".ps-js-widget-online-members").not("."+r);t.each(p.proxy(function(t,e){var i=p(e).addClass(r),n=i.find(".ps-js-widget-content"),o=+i.data("hideempty"),s=+i.data("totalmember"),a=+i.data("limit");this.getData(a,s).done(function(t,e){e&&o?(n.empty(),i.hide()):(n.html(t),i.show())})},this))},getData:function(i,n){return p.Deferred(function(e){var t={};setTimeout(function(){t.limit=+i,t.totalmember=n?1:0,peepso.getJson("widgetajax.online_members",t,function(t){t.success?e.resolve(t.data.html,+t.data.empty):e.reject()})},3e3)})}},peepso.widget=peepso.widget||{},peepso.widget.onlineMembers=o,n(n.proxy(o.init,o))},{}],19:[function(t,e,i){"use strict";var n;(n=jQuery)(function(){new(function(t){function e(){this.$el=t(".ps-widget--profile"),this.$el.length&&this.init()}return e.prototype={init:function(){this.$el.find(".ps-widget--profile__notifications").length&&ps_observer.do_action("notification_start"),this.$coverImage=this.$el.find(".ps-widget--profile__cover-image"),this.$coverImage.length&&ps_observer.add_action("profile_cover_update",this.coverUpdate,10,2,this)},coverUpdate:function(t,e){+t==+peepsodata.currentuserid&&this.$coverImage.css("background","url("+e+") no-repeat center center")}},e}(n))})},{}],20:[function(t,e,i){var n,o;n="undefined"!=typeof window?window:this,o=function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var n=this._onceEvents&&this._onceEvents[t],o=0;o<i.length;o++){var s=i[o];n&&n[s]&&(this.off(t,s),delete n[s]),s.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t},"function"==typeof define&&define.amd?define(o):"object"==typeof e&&e.exports?e.exports=o():n.EvEmitter=o()},{}],21:[function(t,n,e){!function(e,i){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(t){return i(e,t)}):"object"==typeof n&&n.exports?n.exports=i(e,t("ev-emitter")):e.imagesLoaded=i(e,e.EvEmitter)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var s=e.jQuery,a=e.console;function r(t,e){for(var i in e)t[i]=e[i];return t}var p=Array.prototype.slice;function h(t,e,i){if(!(this instanceof h))return new h(t,e,i);var n,o=t;("string"==typeof t&&(o=document.querySelectorAll(t)),o)?(this.elements=(n=o,Array.isArray(n)?n:"object"==typeof n&&"number"==typeof n.length?p.call(n):[n]),this.options=r({},this.options),"function"==typeof e?i=e:r(this.options,e),i&&this.on("always",i),this.getImages(),s&&(this.jqDeferred=new s.Deferred),setTimeout(this.check.bind(this))):a.error("Bad element for imagesLoaded "+(o||t))}(h.prototype=Object.create(t.prototype)).options={},h.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},h.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),!0===this.options.background&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&u[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var s=t.querySelectorAll(this.options.background);for(n=0;n<s.length;n++){var a=s[n];this.addElementBackgroundImages(a)}}}};var u={1:!0,9:!0,11:!0};function i(t){this.img=t}function n(t,e){this.url=t,this.element=e,this.img=new Image}return h.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,t),n=i.exec(e.backgroundImage)}},h.prototype.addImage=function(t){var e=new i(t);this.images.push(e)},h.prototype.addBackground=function(t,e){var i=new n(t,e);this.images.push(i)},h.prototype.check=function(){var n=this;function e(t,e,i){setTimeout(function(){n.progress(t,e,i)})}this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach(function(t){t.once("progress",e),t.check()}):this.complete()},h.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,t,e)},h.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},(i.prototype=Object.create(t.prototype)).check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},i.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},i.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},i.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},i.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},i.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},(n.prototype=Object.create(i.prototype)).check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},n.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},n.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},h.makeJQueryPlugin=function(t){(t=t||e.jQuery)&&((s=t).fn.imagesLoaded=function(t,e){return new h(this,t,e).jqDeferred.promise(s(this))})},h.makeJQueryPlugin(),h})},{"ev-emitter":20}],22:[function(t,n,e){(function(t){var e,i;e=this,i=function(){var e,B="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this,R=B.document;function i(a,r){"use strict";var s,t,p={},h={},u=(r=r||{}).auto||0,e=!1,i=function(){},c=function(t){setTimeout(t||i,0)},d={addEventListener:!!B.addEventListener,touch:"ontouchstart"in B||B.DocumentTouch&&R instanceof DocumentTouch,transitions:function(t){var e=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var i in e)if(void 0!==t.style[e[i]])return!0;return!1}(R.createElement("swipe"))};if(a){var l,f,v,g,b=a.children[0],m=parseInt(r.startSlide,10)||0,y=r.speed||300;r.continuous=void 0===r.continuous||r.continuous;var n,o,_,x=(o="direction",(n=a).currentStyle?_=n.currentStyle[o]:B.getComputedStyle&&(_=B.getComputedStyle(n,null).getPropertyValue(o)),"rtl"===_?"right":"left");r.autoRestart=void 0!==r.autoRestart&&r.autoRestart;var w=function(i,n){n=n||100;var o=null;function s(){o&&clearTimeout(o)}function t(){var t=this,e=arguments;s(),o=setTimeout(function(){o=null,i.apply(t,e)},n)}return t.cancel=s,t}(E),$={handleEvent:function(t){if(!e){switch(t.type){case"mousedown":case"touchstart":this.start(t);break;case"mousemove":case"touchmove":this.move(t);break;case"mouseup":case"mouseleave":case"touchend":this.end(t);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":this.transitionEnd(t);break;case"resize":w()}r.stopPropagation&&t.stopPropagation()}},start:function(t){var e;q(t)?(e=t).preventDefault():e=t.touches[0],p={x:e.pageX,y:e.pageY,time:+new Date},s=void 0,h={},q(t)?(b.addEventListener("mousemove",this,!1),b.addEventListener("mouseup",this,!1),b.addEventListener("mouseleave",this,!1)):(b.addEventListener("touchmove",this,!1),b.addEventListener("touchend",this,!1))},move:function(t){var e;if(q(t))e=t;else{if(1<t.touches.length||t.scale&&1!==t.scale)return;r.disableScroll&&t.preventDefault(),e=t.touches[0]}h={x:e.pageX-p.x,y:e.pageY-p.y},void 0===s&&(s=!!(s||Math.abs(h.x)<Math.abs(h.y))),s||(t.preventDefault(),A(),r.continuous?(I(L(m-1),h.x+f[L(m-1)],0),I(m,h.x+f[m],0),I(L(m+1),h.x+f[L(m+1)],0)):(h.x=h.x/(!m&&0<h.x||m===l.length-1&&h.x<0?Math.abs(h.x)/v+1:1),I(m-1,h.x+f[m-1],0),I(m,h.x+f[m],0),I(m+1,h.x+f[m+1],0)))},end:function(t){var e=+new Date-p.time,i=Number(e)<250&&20<Math.abs(h.x)||Math.abs(h.x)>v/2,n=!m&&0<h.x||m===l.length-1&&h.x<0;r.continuous&&(n=!1);var o=Math.abs(h.x)/h.x;s||(i&&!n?(o<0?(r.continuous?(M(L(m-1),-v,0),M(L(m+2),v,0)):M(m-1,-v,0),M(m,f[m]-v,y),M(L(m+1),f[L(m+1)]-v,y),m=L(m+1)):(r.continuous?(M(L(m+1),v,0),M(L(m-2),-v,0)):M(m+1,v,0),M(m,f[m]+v,y),M(L(m-1),f[L(m-1)]+v,y),m=L(m-1)),C(O(),l[m],o)):r.continuous?(M(L(m-1),-v,y),M(m,0,y),M(L(m+1),v,y)):(M(m-1,-v,y),M(m,0,y),M(m+1,v,y))),q(t)?(b.removeEventListener("mousemove",$,!1),b.removeEventListener("mouseup",$,!1),b.removeEventListener("mouseleave",$,!1)):(b.removeEventListener("touchmove",$,!1),b.removeEventListener("touchend",$,!1))},transitionEnd:function(t){parseInt(t.target.getAttribute("data-index"),10)===m&&((u||r.autoRestart)&&S(),T(O(),l[m]))}};return E(),P(),{setup:E,slide:function(t,e){A(),D(t,e)},prev:function(){A(),function(){if(e)return;r.continuous?D(m-1):m&&D(m-1)}()},next:function(){A(),Q()},restart:S,stop:A,getPos:O,disable:function(){A(),e=!0},enable:function(){e=!1,S()},getNumSlides:function(){return g},kill:function(){A(),a.style.visibility="",b.style.width="",b.style[x]="";var t=l.length;for(;t--;){d.transitions&&I(t,0,0);var e=l[t];if(e.getAttribute("data-cloned")){var i=e.parentElement;i.removeChild(e)}e.style.width="",e.style[x]="",e.style.webkitTransitionDuration=e.style.MozTransitionDuration=e.style.msTransitionDuration=e.style.OTransitionDuration=e.style.transitionDuration="",e.style.webkitTransform=e.style.msTransform=e.style.MozTransform=e.style.OTransform=""}j(),w.cancel()}}}function j(){d.addEventListener?(b.removeEventListener("touchstart",$,!1),b.removeEventListener("mousedown",$,!1),b.removeEventListener("webkitTransitionEnd",$,!1),b.removeEventListener("msTransitionEnd",$,!1),b.removeEventListener("oTransitionEnd",$,!1),b.removeEventListener("otransitionend",$,!1),b.removeEventListener("transitionend",$,!1),B.removeEventListener("resize",$,!1)):B.onresize=null}function k(t){var e=t.cloneNode(!0);b.appendChild(e),e.setAttribute("data-cloned",!0),e.removeAttribute("id")}function E(t){if(null!=t)for(var e in t)r[e]=t[e];l=b.children,g=l.length;for(var i=0;i<l.length;i++)l[i].getAttribute("data-cloned")&&g--;if(l.length<2&&(r.continuous=!1),d.transitions&&r.continuous&&l.length<3&&(k(l[0]),k(l[1]),l=b.children),"right"===x)for(var n=0;n<l.length;n++)l[n].style.float="right";f=new Array(l.length),v=a.getBoundingClientRect().width||a.offsetWidth,b.style.width=l.length*v*2+"px";for(var o=l.length;o--;){var s=l[o];s.style.width=v+"px",s.setAttribute("data-index",o),d.transitions&&(s.style[x]=o*-v+"px",M(o,o<m?-v:m<o?v:0,0))}r.continuous&&d.transitions&&(M(L(m-1),-v,0),M(L(m+1),v,0)),d.transitions||(b.style[x]=m*-v+"px"),a.style.visibility="visible",j(),d.addEventListener?(d.touch&&b.addEventListener("touchstart",$,!1),r.draggable&&b.addEventListener("mousedown",$,!1),d.transitions&&(b.addEventListener("webkitTransitionEnd",$,!1),b.addEventListener("msTransitionEnd",$,!1),b.addEventListener("oTransitionEnd",$,!1),b.addEventListener("otransitionend",$,!1),b.addEventListener("transitionend",$,!1)),B.addEventListener("resize",$,!1)):B.onresize=w}function Q(){e||(r.continuous?D(m+1):m<l.length-1&&D(m+1))}function C(t,e,i){r.callback&&r.callback(t,e,i)}function T(t,e){r.transitionEnd&&r.transitionEnd(t,e)}function L(t){return(l.length+t%l.length)%l.length}function O(){var t=m;return g<=t&&(t-=g),t}function D(t,e){if(t="number"!=typeof t?parseInt(t,10):t,m!==t){if(d.transitions){var i=Math.abs(m-t)/(m-t);if(r.continuous){var n=i;(i=-f[L(t)]/v)!==n&&(t=-i*l.length+t)}for(var o=Math.abs(m-t)-1;o--;)M(L((m<t?t:m)-o-1),v*i,0);t=L(t),M(m,v*i,e||y),M(t,0,e||y),r.continuous&&M(L(t-i),-v*i,0)}else t=L(t),function(e,i,n){if(!n)return b.style[x]=i+"px";var o=+new Date,s=setInterval(function(){var t=+new Date-o;if(n<t)return b.style[x]=i+"px",(u||r.autoRestart)&&S(),T(O(),l[m]),void clearInterval(s);b.style[x]=(i-e)*(Math.floor(t/n*100)/100)+e+"px"},4)}(m*-v,t*-v,e||y);m=t,c(function(){C(O(),l[m],i)})}}function M(t,e,i){I(t,e,i),f[t]=e}function I(t,e,i){var n=l[t],o=n&&n.style;o&&(o.webkitTransitionDuration=o.MozTransitionDuration=o.msTransitionDuration=o.OTransitionDuration=o.transitionDuration=i+"ms",o.webkitTransform="translate("+e+"px,0)translateZ(0)",o.msTransform=o.MozTransform=o.OTransform="translateX("+e+"px)")}function P(){(u=r.auto||0)&&(t=setTimeout(Q,u))}function A(){u=0,clearTimeout(t)}function S(){A(),P()}function q(t){return/^mouse/.test(t.type)}}return(B.jQuery||B.Zepto)&&((e=B.jQuery||B.Zepto).fn.Swipe=function(t){return this.each(function(){e(this).data("Swipe",new i(e(this)[0],t))})}),i},"function"==typeof define&&define.amd?define([],function(){return e.Swipe=i(),e.Swipe}):"object"==typeof n&&n.exports?n.exports=i():e.Swipe=i()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[3]);